angular.module("sandglitch").service("GlitchViewerService",function(e,t){function n(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),s=o.length,i=new Uint8Array(s);s--;)i[s]=o.charCodeAt(s);return new Blob([i],{type:n})}this.effects=[],this.updateImage=function(e){this.imageToGlitch=e},this.sendImage=function(o,s){var i=this,r=t.defer();o=this.imageToGlitch;var a=new FormData,c=n(o);return console.log(s),a.append("image",c,"temp.jpg"),a.append("effects",angular.toJson(s)),console.log(a),e.post("/api/sand",a,{headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e||[];console.log("post success",e),i.glitchUrl=e,r.resolve(t)}).error(function(e){console.log(e),r.reject(e)}),r.promise}});