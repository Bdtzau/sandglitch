angular.module("sandglitch").service("GlitchViewerService",function(e,t){function n(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),i=o.length,r=new Uint8Array(i);i--;)r[i]=o.charCodeAt(i);return new Blob([r],{type:n})}this.effects=[],this.updateImage=function(e){this.imageToGlitch=e},this.sendImage=function(o,i){var r=t.defer();o=this.imageToGlitch;var s=new FormData,a=n(o);return s.append("image",a,"temp.jpg"),s.append("effects",i),console.log(s),e.post("/api/sand",s,{headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e||[];console.log("post success",e),r.resolve(t)}).error(function(e){console.log(e),r.reject(e)}),r.promise}});